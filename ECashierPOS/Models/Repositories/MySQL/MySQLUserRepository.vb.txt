Imports ECashierPOS.Models.Entities
Imports ECashierPOS.Models.Interfaces

Namespace Models.Repositories
    Public Class MySQLUserRepository
        Inherits MySQLGenericRepository(Of User)
        Implements IUserRepository

        Public Sub New(connectionString As String)
            MyBase.New(connectionString)
        End Sub
        Protected Overrides ReadOnly Property TableName As String
            Get
                Return "users"
            End Get
        End Property

        Protected Overrides ReadOnly Property DefaultOrderBy As String
            Get
                Return "full_name"
            End Get
        End Property

        Protected Overrides Function MapEntity(reader As MySql.Data.MySqlClient.MySqlDataReader) As User
            Return New User With {
                .Id = reader("id").ToString(),
                .FullName = reader("full_name").ToString(),
                .Username = reader("username").ToString(),
                .Password = reader("password").ToString(),
                .Role = reader("role").ToString(),
                .CreatedAt = Convert.ToDateTime(reader("created_at")),
                .UpdatedAt = If(IsDBNull(reader("updated_at")), Nothing, CType(reader("updated_at"), DateTime?))
            }
        End Function

        Protected Overrides Function MapFields(entity As User) As Dictionary(Of String, Object)
            Return New Dictionary(Of String, Object) From {
                {"id", entity.Id},
                {"full_name", entity.FullName},
                {"username", entity.Username},
                {"password", entity.Password},
                {"role", entity.Role}
            }
        End Function
    End Class
End Namespace
